# 第 15 章 部分型付け

> テキストの解答要約はこんな感じで引用表現にする（引用じゃないけど）

## 演習 15.2.1. [$\star$]

$$
\displaystyle\frac{
    \displaystyle\frac{
    	
    }{
    	\textsf{\{y:Nat, x:Nat, z:Nat\} <: \{y:Nat\}}
    } \quad \textrm{S-RcdWidth}
}{
    \textsf{\{x:Nat, y:Nat, z:Nat\} <: \{y:Nat\}}
} \quad \textrm{S-RcdPerm}
$$

>A. 最初の時点でS-RcdPermは適用できない。S-Transで $\textsf{\{y:Nat, x:Nat, z:Nat\}}$ を挟んであげる必要がある。

#### Note

- S-Arrow についての理解
  - 引数では指定した型かその下位の型だけを認め、返り値は指定した型よりも上位の型をとりうる。
- 部分型関係が前順序であることについての理解
  - S-Refl は反射性、 S-Trans は推移性を表す
  - 並び替えたレコードは互いに部分型関係になるので、反対称性（$aRb \wedge bRa \Rightarrow a = b$）が成立しない。 
    - 半順序にはならない

## 演習 15.2.2. [$\star$]

S-RcdPerm を複数回適用した導出がありうる（あまり意味はないが）。

> A. 正解だと思う。例1. T-Appも複数のパターンが用意できる。 例2. S-Trans で 同じ型を生やしまくる導出がある。

## 演習 15.2.3. [$\star$]

- (1) 5つ。
  - $\textsf{\{b:Top, a:Top\}}$
  - $\textsf{\{a:Top\}}$
  - $\textsf{\{b:Top\}}$
  - $\textsf{\{\}}$
  - $\textsf{Top}$
- (2) 2つ以上の要素を持つレコード型は要素の順列間で相互に部分型関係が成り立つ。これを利用して無限降下列を作ることができる。
- (3) 同様。

> A. 
> (1) 6つ。S-Refl で手に入るもともとのレコードが抜けてる。
> (2) (3) 解答例を見るに多分誤りで、有限個の要素を持つレコード型の順列は有限個であり、その**異なる**部分型関係は有限個である。（巡回してもよい部分型関係なら単一要素でも良いことになる。）無限にしたければ (2) レコードの要素を生やしまくる無限降下列 (3) さっきの無限降下列を引数とした関数の無限上昇列 のように、すべて異なる型の列にする必要がありそう。

## 演習 15.2.4. [$\star$]

- 他のすべての型の部分型となる型はない。
- 矢印型で、他のすべての矢印型の上位型となる型は $\sf Top$ である。

> A. ない。  $\mathsf{T \rarr T <: Top}$ みたいなことにはならない。

## 演習 15.2.5. [$\star\star$]

レコードと違い、要素を並べ替えた型は部分型関係が必ずしも成立するわけではない。そのため、 $\mathsf{T_1 \times T_2 <: T_2}$ のような型付け規則が追加で必要になる。

> A. 型強制意味論を採用しなければ、行き詰まりの項が正しく型付けできてしまい、進行則を脅かす。